```python
'''
Pandas时刻数据：Timestamp

时刻数据代表时间点，是pandas的数据类型，是将值与时间点相关联的最基本类型的时间序列数据

pandas.Timestamp()

'''
```




    '\nPandas时刻数据：Timestamp\n\n时刻数据代表时间点，是pandas的数据类型，是将值与时间点相关联的最基本类型的时间序列数据\n\npandas.Timestamp()\n\n'




```python
# pd.Timestamp()
import numpy as np
import pandas as pd
import datetime

d1 = datetime.datetime(2016,12,1,12,45,30)
d2 = '2017-12-21'
t1 = pd.Timestamp(d1)
t2 = pd.Timestamp(d2)
print(t1, type(t1))
print(t2, type(t2))


# 生成pandas的时刻数据 —— 时间戳

```

    2016-12-01 12:45:30 <class 'pandas._libs.tslibs.timestamps.Timestamp'>
    2017-12-21 00:00:00 <class 'pandas._libs.tslibs.timestamps.Timestamp'>
    


```python
# pd.to_datetime
from datetime import datetime

d1 = datetime(2016,12,1,12,45,32)
d2 = '2017-12-21'
t1 = pd.to_datetime(d1)
t2 = pd.to_datetime(d2)
print(t1, type(t1))
print(t2, type(t2))
     # pd.to_datetime()：如果是单个时间数据，转换成pandas的时刻数据，数据类型为Timestamp
    
date_lst = ['2018-2-3','2019-12-23','2019-3-19']
t3 = pd.to_datetime(date_lst)
print(t3, type(t3))
   # 多个时间数据，将会转换为pandas的DatetimeIndex,可以通过t3[0]来索引

date_lst2 = ['2018-2-3','2019-12-23','2019-3-19','999039','2018-3-11','2015-5-1','2000-12-3']
t4 = pd.to_datetime(date_lst2, errors='ignore')      
                # 当一组时间序列中夹杂其他格式数据，可用errors参数返回
                    # errors = 'ignore':不可解析时返回原始输入，这里就是直接生成一般数组
print(t4, type(t4))

t5 = pd.to_datetime(date_lst2, errors='coerce')  # errors='coerce', 其他错误格式会返回NaT（Not a Time）
print(t5)
```

    2016-12-01 12:45:32 <class 'pandas._libs.tslibs.timestamps.Timestamp'>
    2017-12-21 00:00:00 <class 'pandas._libs.tslibs.timestamps.Timestamp'>
    DatetimeIndex(['2018-02-03', '2019-12-23', '2019-03-19'], dtype='datetime64[ns]', freq=None) <class 'pandas.core.indexes.datetimes.DatetimeIndex'>
    Index(['2018-2-3', '2019-12-23', '2019-3-19', '999039', '2018-3-11',
           '2015-5-1', '2000-12-3'],
          dtype='object') <class 'pandas.core.indexes.base.Index'>
    DatetimeIndex(['2018-02-03', '2019-12-23', '2019-03-19',        'NaT',
                   '2018-03-11', '2015-05-01', '2000-12-03'],
                  dtype='datetime64[ns]', freq=None)
    


```python
# 作业
# 1. 请通过迭代创建一个时间列表（如图，时间区间为任意一个月，这里可以用for语句），然后转化成DatetimeIndex，并print月中是多少号

import pandas as pd

date = []
for i in range(1,32):
    a = '2019-8-'
    s = a + str(i)
    date.append(s)
print(date)

pdt = pd.to_datetime(date)
print(pdt)
print('月中日期为：{}'.format(pdt[15]))
```

    ['2019-8-1', '2019-8-2', '2019-8-3', '2019-8-4', '2019-8-5', '2019-8-6', '2019-8-7', '2019-8-8', '2019-8-9', '2019-8-10', '2019-8-11', '2019-8-12', '2019-8-13', '2019-8-14', '2019-8-15', '2019-8-16', '2019-8-17', '2019-8-18', '2019-8-19', '2019-8-20', '2019-8-21', '2019-8-22', '2019-8-23', '2019-8-24', '2019-8-25', '2019-8-26', '2019-8-27', '2019-8-28', '2019-8-29', '2019-8-30', '2019-8-31']
    DatetimeIndex(['2019-08-01', '2019-08-02', '2019-08-03', '2019-08-04',
                   '2019-08-05', '2019-08-06', '2019-08-07', '2019-08-08',
                   '2019-08-09', '2019-08-10', '2019-08-11', '2019-08-12',
                   '2019-08-13', '2019-08-14', '2019-08-15', '2019-08-16',
                   '2019-08-17', '2019-08-18', '2019-08-19', '2019-08-20',
                   '2019-08-21', '2019-08-22', '2019-08-23', '2019-08-24',
                   '2019-08-25', '2019-08-26', '2019-08-27', '2019-08-28',
                   '2019-08-29', '2019-08-30', '2019-08-31'],
                  dtype='datetime64[ns]', freq=None)
    月中日期为：2019-08-16 00:00:00
    


```python
# 2. 请如图创建一个包含时间日期的txt文件，通过open语句读取后转化成DatetimeIndex

l = []
with open(r'D:\PY\文本文档\时间.txt') as f:
    for i in f.read().split(','):
        l.append(i)
print(l)
    
pdt = pd.to_datetime(l)
print(pdt)
```

    ['20150101', '20150102', '20150103', '20150104', '20150105', '20150106', '20150107', '20150108']
    DatetimeIndex(['2015-01-01', '2015-01-02', '2015-01-03', '2015-01-04',
                   '2015-01-05', '2015-01-06', '2015-01-07', '2015-01-08'],
                  dtype='datetime64[ns]', freq=None)
    


```python
'''
Pandas时间戳索引：DatetimeIndex

核心：pd.date_range()

'''
```




    '\nPandas时间戳索引：DatetimeIndex\n\n核心：pd.date_range()\n\n'




```python
# pd.DatetimeIndex()与TimeSeries时间序列

rng = pd.DatetimeIndex(['12/1/2017','12/2/2017','12/3/2017','12/4/2017','12/5/2017'])
print(rng, type(rng))
print(rng[0], type(rng[0]))
     # 直接生成时间戳索引，支持str、datetime.datetime
    # 单个时间戳为Timestamp，多个时间戳为DatetimeIndex

s = pd.Series(np.random.rand(len(rng)), index=rng)
print(s, type(s))
    # 以DatetimeIndex为index的Series，为TimeSries，时间序列
print(s.index)
```

    DatetimeIndex(['2017-12-01', '2017-12-02', '2017-12-03', '2017-12-04',
                   '2017-12-05'],
                  dtype='datetime64[ns]', freq=None) <class 'pandas.core.indexes.datetimes.DatetimeIndex'>
    2017-12-01 00:00:00 <class 'pandas._libs.tslibs.timestamps.Timestamp'>
    2017-12-01    0.848215
    2017-12-02    0.258869
    2017-12-03    0.411305
    2017-12-04    0.185912
    2017-12-05    0.537327
    dtype: float64 <class 'pandas.core.series.Series'>
    DatetimeIndex(['2017-12-01', '2017-12-02', '2017-12-03', '2017-12-04',
                   '2017-12-05'],
                  dtype='datetime64[ns]', freq=None)
    


```python
'''
pd.date_range() ：生成日期范围
2种生成方式：①start + end； ②start/end + periods
默认频率：day
'''

r1 = pd.date_range('1.1.2007','1.10.2007')           # start + end
print(r1)

r2 = pd.date_range(start='1.1.2017', periods=10)       # start + period
print(r2)

r3 = pd.date_range(end='1.30.2017 14:00:00', periods=10)  # end + period
print(r3)

r4 = pd.date_range(end='1.30.2017 14:00:00', periods=10, normalize=True)  # normalize=True,将日期规范为午夜，打印发现时间没有了，只有日期
print(r4)

# 直接生成DatetimeIndex
# pd.date_range(start=None, end=None, periods=None, freq='D', tz=None, normalize=False, name=None, closed=None, **kwargs)
# start：开始时间
# end：结束时间
# periods：偏移量
# freq：频率，默认天，pd.date_range()默认频率为日历日，pd.bdate_range()默认频率为工作日
# tz：时区
# closed=None，左闭右闭， closed='right' 左开右闭， closed='left' 左闭右开

r5 = pd.bdate_range(start='1.1.2017', periods=10)   # 只打印出工作日
print(r5)


r6 = pd.date_range('20180309','20180315')       # 多种格式可以读取
print(r6)

print(pd.date_range('20180309','20180315',closed='right'))     # 左开右闭
print(pd.date_range('20180309','20180315',closed='left'))           # 左闭右开


print(list(r6), list(r6)[0])       # 可以直接转化为list，元素为Timestamp类型

```

    DatetimeIndex(['2007-01-01', '2007-01-02', '2007-01-03', '2007-01-04',
                   '2007-01-05', '2007-01-06', '2007-01-07', '2007-01-08',
                   '2007-01-09', '2007-01-10'],
                  dtype='datetime64[ns]', freq='D')
    DatetimeIndex(['2017-01-01', '2017-01-02', '2017-01-03', '2017-01-04',
                   '2017-01-05', '2017-01-06', '2017-01-07', '2017-01-08',
                   '2017-01-09', '2017-01-10'],
                  dtype='datetime64[ns]', freq='D')
    DatetimeIndex(['2017-01-21 14:00:00', '2017-01-22 14:00:00',
                   '2017-01-23 14:00:00', '2017-01-24 14:00:00',
                   '2017-01-25 14:00:00', '2017-01-26 14:00:00',
                   '2017-01-27 14:00:00', '2017-01-28 14:00:00',
                   '2017-01-29 14:00:00', '2017-01-30 14:00:00'],
                  dtype='datetime64[ns]', freq='D')
    DatetimeIndex(['2017-01-21', '2017-01-22', '2017-01-23', '2017-01-24',
                   '2017-01-25', '2017-01-26', '2017-01-27', '2017-01-28',
                   '2017-01-29', '2017-01-30'],
                  dtype='datetime64[ns]', freq='D')
    DatetimeIndex(['2017-01-02', '2017-01-03', '2017-01-04', '2017-01-05',
                   '2017-01-06', '2017-01-09', '2017-01-10', '2017-01-11',
                   '2017-01-12', '2017-01-13'],
                  dtype='datetime64[ns]', freq='B')
    DatetimeIndex(['2018-03-09', '2018-03-10', '2018-03-11', '2018-03-12',
                   '2018-03-13', '2018-03-14', '2018-03-15'],
                  dtype='datetime64[ns]', freq='D')
    DatetimeIndex(['2018-03-10', '2018-03-11', '2018-03-12', '2018-03-13',
                   '2018-03-14', '2018-03-15'],
                  dtype='datetime64[ns]', freq='D')
    DatetimeIndex(['2018-03-09', '2018-03-10', '2018-03-11', '2018-03-12',
                   '2018-03-13', '2018-03-14'],
                  dtype='datetime64[ns]', freq='D')
    [Timestamp('2018-03-09 00:00:00', freq='D'), Timestamp('2018-03-10 00:00:00', freq='D'), Timestamp('2018-03-11 00:00:00', freq='D'), Timestamp('2018-03-12 00:00:00', freq='D'), Timestamp('2018-03-13 00:00:00', freq='D'), Timestamp('2018-03-14 00:00:00', freq='D'), Timestamp('2018-03-15 00:00:00', freq='D')] 2018-03-09 00:00:00
    


```python
# pd.date_range()-日期范围：freq   频率(1)


print(pd.date_range('2019/9/1', '2019/9/10'))    # 默认freq='D' :每日历日

print(pd.date_range('2019/9/1', '2019/9/10', freq='B'))    # 'B':每工作日

print(pd.date_range('2019/9/1', '2019/9/10', freq='H'))    # 'H':每小时

print(pd.date_range('2019/9/1 12:00', '2019/9/1 12:10', freq='T'))    # 'T'/'MIN':每分钟

print(pd.date_range('2019/9/1 12:00:00', '2019/9/1 12:00:10', freq='S'))    # 'S':每秒

print(pd.date_range('2019/9/1 12:00:00', '2019/9/1 12:00:10', freq='L'))    # 'L':每毫秒

print(pd.date_range('2019/9/1 12:00:00', '2019/9/1 12:00:10', freq='U'))    # 'U':每微秒
```

    DatetimeIndex(['2019-09-01', '2019-09-02', '2019-09-03', '2019-09-04',
                   '2019-09-05', '2019-09-06', '2019-09-07', '2019-09-08',
                   '2019-09-09', '2019-09-10'],
                  dtype='datetime64[ns]', freq='D')
    DatetimeIndex(['2019-09-02', '2019-09-03', '2019-09-04', '2019-09-05',
                   '2019-09-06', '2019-09-09', '2019-09-10'],
                  dtype='datetime64[ns]', freq='B')
    DatetimeIndex(['2019-09-01 00:00:00', '2019-09-01 01:00:00',
                   '2019-09-01 02:00:00', '2019-09-01 03:00:00',
                   '2019-09-01 04:00:00', '2019-09-01 05:00:00',
                   '2019-09-01 06:00:00', '2019-09-01 07:00:00',
                   '2019-09-01 08:00:00', '2019-09-01 09:00:00',
                   ...
                   '2019-09-09 15:00:00', '2019-09-09 16:00:00',
                   '2019-09-09 17:00:00', '2019-09-09 18:00:00',
                   '2019-09-09 19:00:00', '2019-09-09 20:00:00',
                   '2019-09-09 21:00:00', '2019-09-09 22:00:00',
                   '2019-09-09 23:00:00', '2019-09-10 00:00:00'],
                  dtype='datetime64[ns]', length=217, freq='H')
    DatetimeIndex(['2019-09-01 12:00:00', '2019-09-01 12:01:00',
                   '2019-09-01 12:02:00', '2019-09-01 12:03:00',
                   '2019-09-01 12:04:00', '2019-09-01 12:05:00',
                   '2019-09-01 12:06:00', '2019-09-01 12:07:00',
                   '2019-09-01 12:08:00', '2019-09-01 12:09:00',
                   '2019-09-01 12:10:00'],
                  dtype='datetime64[ns]', freq='T')
    DatetimeIndex(['2019-09-01 12:00:00', '2019-09-01 12:00:01',
                   '2019-09-01 12:00:02', '2019-09-01 12:00:03',
                   '2019-09-01 12:00:04', '2019-09-01 12:00:05',
                   '2019-09-01 12:00:06', '2019-09-01 12:00:07',
                   '2019-09-01 12:00:08', '2019-09-01 12:00:09',
                   '2019-09-01 12:00:10'],
                  dtype='datetime64[ns]', freq='S')
    DatetimeIndex([       '2019-09-01 12:00:00', '2019-09-01 12:00:00.001000',
                   '2019-09-01 12:00:00.002000', '2019-09-01 12:00:00.003000',
                   '2019-09-01 12:00:00.004000', '2019-09-01 12:00:00.005000',
                   '2019-09-01 12:00:00.006000', '2019-09-01 12:00:00.007000',
                   '2019-09-01 12:00:00.008000', '2019-09-01 12:00:00.009000',
                   ...
                   '2019-09-01 12:00:09.991000', '2019-09-01 12:00:09.992000',
                   '2019-09-01 12:00:09.993000', '2019-09-01 12:00:09.994000',
                   '2019-09-01 12:00:09.995000', '2019-09-01 12:00:09.996000',
                   '2019-09-01 12:00:09.997000', '2019-09-01 12:00:09.998000',
                   '2019-09-01 12:00:09.999000',        '2019-09-01 12:00:10'],
                  dtype='datetime64[ns]', length=10001, freq='L')
    DatetimeIndex([       '2019-09-01 12:00:00', '2019-09-01 12:00:00.000001',
                   '2019-09-01 12:00:00.000002', '2019-09-01 12:00:00.000003',
                   '2019-09-01 12:00:00.000004', '2019-09-01 12:00:00.000005',
                   '2019-09-01 12:00:00.000006', '2019-09-01 12:00:00.000007',
                   '2019-09-01 12:00:00.000008', '2019-09-01 12:00:00.000009',
                   ...
                   '2019-09-01 12:00:09.999991', '2019-09-01 12:00:09.999992',
                   '2019-09-01 12:00:09.999993', '2019-09-01 12:00:09.999994',
                   '2019-09-01 12:00:09.999995', '2019-09-01 12:00:09.999996',
                   '2019-09-01 12:00:09.999997', '2019-09-01 12:00:09.999998',
                   '2019-09-01 12:00:09.999999',        '2019-09-01 12:00:10'],
                  dtype='datetime64[ns]', length=10000001, freq='U')
    


```python
# pd.date_range()-日期范围：freq   频率(2)


print(pd.date_range('2019/9/1', '2019/10/1', freq='W-MON'))  # W-MON 只计算范围内指定的星期几，每周
                                                 # 星期几缩写：MON/TUE/WED/THU/FRI/SAT/SUN

print(pd.date_range('2019/5/1', '2019/10/1', freq='WOM-2MON')) 
                                                    # WOM-2MON：只计算范围内的每月的第几个星期几，这里是每月第二个星期一 
    
    
   # 下面这几种情况是左闭右开的

print(pd.date_range('2018','2019',freq='M'))  # M：每月最后一个日历日    

print(pd.date_range('2017','2020',freq='Q-JAN'))  # Q-月：指定月为季度末，按每个季度最后一个日历日计算     

print(pd.date_range('2017','2020',freq='A-JUL'))   # A-月：每年的指定月的最后一个日历日      

    # 月缩写：JAN/FEB/MAR/APR/MAY/JUN/JUL/AUG/SEP/OCT/NOV/DEC
        # 所以Q-月只有三种情况：1-4-7-10,2-5-8-11,3-6-9-12
        
print(pd.date_range('2017','2018', freq = 'MS'))     # MS：每月第一个日历日

print(pd.date_range('2017','2020', freq = 'QS-MAY'))  # QS-月：指定月为季度末，按每个季度末第一个日历日计算

print(pd.date_range('2017','2020', freq = 'AS-OCT'))  # AS-月：每年的指定月的第一个日历日 
print('--'*30)
       
print(pd.date_range('2017','2018', freq = 'BM'))      # BM：每月最后一个工作日

print(pd.date_range('2017','2020', freq = 'BQ-DEC'))    # BQ-月：指定月为季度末，每个季度末的最后一个工作日

print(pd.date_range('2017','2020', freq = 'BA-DEC'))    # BA-月：每年指定月份的最后一个工作日


print(pd.date_range('2017','2018', freq = 'BMS'))       # BMS：每月第一个工作日

print(pd.date_range('2017','2020', freq = 'BQS-DEC'))     # BQS-月：指定月为季度末，每个季度末的第一个工作日

print(pd.date_range('2017','2020', freq = 'BAS-SEP'))    # BAS-月：每年指定月份的第一个工作日

```

    DatetimeIndex(['2019-09-02', '2019-09-09', '2019-09-16', '2019-09-23',
                   '2019-09-30'],
                  dtype='datetime64[ns]', freq='W-MON')
    DatetimeIndex(['2019-05-13', '2019-06-10', '2019-07-08', '2019-08-12',
                   '2019-09-09'],
                  dtype='datetime64[ns]', freq='WOM-2MON')
    DatetimeIndex(['2018-01-31', '2018-02-28', '2018-03-31', '2018-04-30',
                   '2018-05-31', '2018-06-30', '2018-07-31', '2018-08-31',
                   '2018-09-30', '2018-10-31', '2018-11-30', '2018-12-31'],
                  dtype='datetime64[ns]', freq='M')
    DatetimeIndex(['2017-01-31', '2017-04-30', '2017-07-31', '2017-10-31',
                   '2018-01-31', '2018-04-30', '2018-07-31', '2018-10-31',
                   '2019-01-31', '2019-04-30', '2019-07-31', '2019-10-31'],
                  dtype='datetime64[ns]', freq='Q-JAN')
    DatetimeIndex(['2017-07-31', '2018-07-31', '2019-07-31'], dtype='datetime64[ns]', freq='A-JUL')
    DatetimeIndex(['2017-01-01', '2017-02-01', '2017-03-01', '2017-04-01',
                   '2017-05-01', '2017-06-01', '2017-07-01', '2017-08-01',
                   '2017-09-01', '2017-10-01', '2017-11-01', '2017-12-01',
                   '2018-01-01'],
                  dtype='datetime64[ns]', freq='MS')
    DatetimeIndex(['2017-02-01', '2017-05-01', '2017-08-01', '2017-11-01',
                   '2018-02-01', '2018-05-01', '2018-08-01', '2018-11-01',
                   '2019-02-01', '2019-05-01', '2019-08-01', '2019-11-01'],
                  dtype='datetime64[ns]', freq='QS-MAY')
    DatetimeIndex(['2017-10-01', '2018-10-01', '2019-10-01'], dtype='datetime64[ns]', freq='AS-OCT')
    ------------------------------------------------------------
    DatetimeIndex(['2017-01-31', '2017-02-28', '2017-03-31', '2017-04-28',
                   '2017-05-31', '2017-06-30', '2017-07-31', '2017-08-31',
                   '2017-09-29', '2017-10-31', '2017-11-30', '2017-12-29'],
                  dtype='datetime64[ns]', freq='BM')
    DatetimeIndex(['2017-03-31', '2017-06-30', '2017-09-29', '2017-12-29',
                   '2018-03-30', '2018-06-29', '2018-09-28', '2018-12-31',
                   '2019-03-29', '2019-06-28', '2019-09-30', '2019-12-31'],
                  dtype='datetime64[ns]', freq='BQ-DEC')
    DatetimeIndex(['2017-12-29', '2018-12-31', '2019-12-31'], dtype='datetime64[ns]', freq='BA-DEC')
    DatetimeIndex(['2017-01-02', '2017-02-01', '2017-03-01', '2017-04-03',
                   '2017-05-01', '2017-06-01', '2017-07-03', '2017-08-01',
                   '2017-09-01', '2017-10-02', '2017-11-01', '2017-12-01',
                   '2018-01-01'],
                  dtype='datetime64[ns]', freq='BMS')
    DatetimeIndex(['2017-03-01', '2017-06-01', '2017-09-01', '2017-12-01',
                   '2018-03-01', '2018-06-01', '2018-09-03', '2018-12-03',
                   '2019-03-01', '2019-06-03', '2019-09-02', '2019-12-02'],
                  dtype='datetime64[ns]', freq='BQS-DEC')
    DatetimeIndex(['2017-09-01', '2018-09-03', '2019-09-02'], dtype='datetime64[ns]', freq='BAS-SEP')
    


```python
# pd.date_range()-日期范围：freq   复合频率

print(pd.date_range('2018/1/1','2018/2/1',freq='7D'))   # 7天

print(pd.date_range('2018/1/1','2018/1/2', freq='2h30min'))  # 2小时30分钟

print(pd.date_range('2018','2019',freq='2M'))   # 每2个月的最后一个日历日
```

    DatetimeIndex(['2018-01-01', '2018-01-08', '2018-01-15', '2018-01-22',
                   '2018-01-29'],
                  dtype='datetime64[ns]', freq='7D')
    DatetimeIndex(['2018-01-01 00:00:00', '2018-01-01 02:30:00',
                   '2018-01-01 05:00:00', '2018-01-01 07:30:00',
                   '2018-01-01 10:00:00', '2018-01-01 12:30:00',
                   '2018-01-01 15:00:00', '2018-01-01 17:30:00',
                   '2018-01-01 20:00:00', '2018-01-01 22:30:00'],
                  dtype='datetime64[ns]', freq='150T')
    DatetimeIndex(['2018-01-31', '2018-03-31', '2018-05-31', '2018-07-31',
                   '2018-09-30', '2018-11-30'],
                  dtype='datetime64[ns]', freq='2M')
    


```python
# asfreq   : 时期频率转换

t = pd.Series(np.random.rand(4), index=pd.date_range('2019/1/1',periods=4))
print(t)

t2 = t.asfreq('12H')
print(t2)

  # 改变频率，这里是D改为12H
    
print(t.asfreq('12H', method='ffill'))

    # method：插值模式，None不插值，ffill用之前值填充，bfill用之后值填充
```

    2019-01-01    0.809695
    2019-01-02    0.201434
    2019-01-03    0.425145
    2019-01-04    0.661457
    Freq: D, dtype: float64
    2019-01-01 00:00:00    0.809695
    2019-01-01 12:00:00         NaN
    2019-01-02 00:00:00    0.201434
    2019-01-02 12:00:00         NaN
    2019-01-03 00:00:00    0.425145
    2019-01-03 12:00:00         NaN
    2019-01-04 00:00:00    0.661457
    Freq: 12H, dtype: float64
    2019-01-01 00:00:00    0.809695
    2019-01-01 12:00:00    0.809695
    2019-01-02 00:00:00    0.201434
    2019-01-02 12:00:00    0.201434
    2019-01-03 00:00:00    0.425145
    2019-01-03 12:00:00    0.425145
    2019-01-04 00:00:00    0.661457
    Freq: 12H, dtype: float64
    


```python
# pd.date_range()-日期范围：超前/滞后数据

t = pd.Series([1,2,3,4], index=pd.date_range('2019/1/1',periods=4))
print(t)
print('-'*10)

print(t.shift(2))      # .shift()   正数，数值后移（滞后）
print('-'*10)

print(t.shift(-2))     # .shift()   负数，数值前移（超前）
print('-'*10)

per = t / t.shift(1) - 1   # 计算变化百分比，这里计算：该时间戳与上一个时间戳相比，变化百分比
print(per)
print('-'*10)

print(t.shift(2, freq='D'))   # 加上freq参数：对时间戳进行位移，而不是对数值进行位移
print(t.shift(2,freq='T'))
```

    2019-01-01    1
    2019-01-02    2
    2019-01-03    3
    2019-01-04    4
    Freq: D, dtype: int64
    ----------
    2019-01-01    NaN
    2019-01-02    NaN
    2019-01-03    1.0
    2019-01-04    2.0
    Freq: D, dtype: float64
    ----------
    2019-01-01    3.0
    2019-01-02    4.0
    2019-01-03    NaN
    2019-01-04    NaN
    Freq: D, dtype: float64
    ----------
    2019-01-01         NaN
    2019-01-02    1.000000
    2019-01-03    0.500000
    2019-01-04    0.333333
    Freq: D, dtype: float64
    ----------
    2019-01-03    1
    2019-01-04    2
    2019-01-05    3
    2019-01-06    4
    Freq: D, dtype: int64
    2019-01-01 00:02:00    1
    2019-01-02 00:02:00    2
    2019-01-03 00:02:00    3
    2019-01-04 00:02:00    4
    Freq: D, dtype: int64
    


```python
# 作业
# 1. 请输出以下时间序列  

# 2017-1-1  freq=D  长度为5 
s1 = pd.Series(np.random.rand(5), index=pd.date_range('2017-1-1',periods=5))
print(s1)

#  2017年指定3个月最后一个日历日 
t = pd.date_range('2017','2018',freq='3M')
s2 = pd.Series(np.random.rand(len(t)), index=t)
print(s2)

# 2017-12-1 每10分钟  4*4
t2=list(pd.date_range('2017-12-1','2017-12-2',freq='10T'))[:4]

df = pd.DataFrame(np.random.rand(16).reshape(4,4),
                  index=t2, 
                  columns=['value1','value2','value3','value4'])
print(df)

```

    2017-01-01    0.591451
    2017-01-02    0.174469
    2017-01-03    0.570109
    2017-01-04    0.499944
    2017-01-05    0.497524
    Freq: D, dtype: float64
    2017-01-31    0.404806
    2017-04-30    0.133619
    2017-07-31    0.178746
    2017-10-31    0.689345
    Freq: 3M, dtype: float64
                           value1    value2    value3    value4
    2017-12-01 00:00:00  0.424267  0.712714  0.404786  0.615762
    2017-12-01 00:10:00  0.819101  0.214449  0.480313  0.857690
    2017-12-01 00:20:00  0.458197  0.414763  0.545671  0.067960
    2017-12-01 00:30:00  0.830673  0.059027  0.053470  0.074866
    


```python
#  2. 按要求创建时间序列ts1，并转换成ts2

t = pd.date_range('20170501 12:00','20170501 12:40', freq='10T')

ts1 = pd.Series(np.random.rand(5), index=t)
print(ts1)

ts2 = ts1.asfreq('5T', method='ffill')
print(ts2)
```

    2017-05-01 12:00:00    0.346940
    2017-05-01 12:10:00    0.924397
    2017-05-01 12:20:00    0.705496
    2017-05-01 12:30:00    0.516342
    2017-05-01 12:40:00    0.582772
    Freq: 10T, dtype: float64
    2017-05-01 12:00:00    0.346940
    2017-05-01 12:05:00    0.346940
    2017-05-01 12:10:00    0.924397
    2017-05-01 12:15:00    0.924397
    2017-05-01 12:20:00    0.705496
    2017-05-01 12:25:00    0.705496
    2017-05-01 12:30:00    0.516342
    2017-05-01 12:35:00    0.516342
    2017-05-01 12:40:00    0.582772
    Freq: 5T, dtype: float64
    
